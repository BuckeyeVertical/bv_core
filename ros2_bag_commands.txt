ALL TERMINALS: cd bv_ws

Terminal 1
__________
source ~/bv_ws/.venv/bin/activate

source /opt/ros/humble/setup.bash

source install/local_setup.bash

colcon build

ros2 launch mavros px4.launch \
	fcu_url:=serial:///dev/ttyUSB0:921600 \
	gcs_url:=udp://@0.0.0.0:14550


Terminal 2
__________
source ~/bv_ws/.venv/bin/activate

source /opt/ros/humble/setup.bash

source install/local_setup.bash

sudo v4l2-ctl -d /dev/video0 --set-ctrl=focus_automatic_continuous=0

sudo v4l2-ctl -d /dev/video0 --set-ctrl=focus_absolute=0

gst-launch-1.0 v4l2src device=/dev/video0 io-mode=2 do-timestamp=true ! image/jpeg,width=3840,height=2160,framerate=24/1 ! jpegdec ! videoconvert ! autovideosink

export GSCAM_CONFIG="v4l2src device=/dev/video0 io-mode=2 do-timestamp=true ! image/jpeg,width=4640,height=3480,framerate=8/1 ! jpegdec ! videoconvert"

export GSCAM_CONFIG="v4l2src device=/dev/video0 io-mode=2 do-timestamp=true ! image/jpeg,width=3840,height=2160,framerate=24/1 ! jpegdec ! videoconvert"

ros2 run gscam2 gscam_main -p use_gst_timestamps=true

ros2 run image_transport republish raw compressed \ 
	--ros-args \
	-r in:=/camera/image_raw -r out:=/camera/image_compressed \
	-p compressed.format:=jpeg \
	-p compressed.jpeg_quality:=80

docker run -it --rm \
	--net=host \
	--ipc=host \
	--privileged \
	-v /dev/bus/usb:/dev/bus/usb \
	gscam-cont:latest \
	bash
	
docker run -it --rm \
	--net=host \
	--device=/dev/video4:/dev/video4
	gscam-cont bash
	
	

Terminal 3
__________
source ~/bv_ws/.venv/bin/activate

source /opt/ros/humble/setup.bash

source install/local_setup.bash

ros2 run bv_core mission


Terminal 4
__________
source ~/bv_ws/.venv/bin/activate

source /opt/ros/humble/setup.bash

source install/local_setup.bash

ros2 run bv_core stitching


Terminal 5
__________
source ~/bv_ws/.venv/bin/activate

source /opt/ros/humble/setup.bash

source install/local_setup.bash

ros2 run bv_core vision_node


Terminal 6
__________
source /opt/ros/humble/setup.bash

source install/local_setup.bash

To record the actual stream:
ros2 bag record -o bag_recording_1 /image_raw /camera_info /mavros/local_position/pose /mavros/state /mavros/global_position/global /mavros/global_position/rel_alt

To record just detections:
ros2 bag record -o bag_recording_1 /obj_dets /mission_state /camera_info /mavros/local_position/pose /mavros/state /mavros/global_position/global /mavros/global_position/rel_alt
